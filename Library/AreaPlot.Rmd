---
pagetitle: "Area Plot"
author: ""
date: ""
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview

This script creates a stacked area plot outlining the number of companies that were founded over a 20 year period split by gender. 

# Load packages

```{r}
# List required packages
packages <- c(
  "tidyverse"
)

# Load packages (change to install = TRUE to install the required packages)
pacman::p_load(packages, character.only = TRUE, install = FALSE)
```

# Prepare data

This graph uses fictional data created for the purpose of this graph.

- `founded`: year a company was founded
- `gender`: categorical variable indicating whether the company is men-led or women-led
- `n_gender`: the number of companies that were founded in that year by gender

```{r, message = FALSE}
# Load the dataset
data <- read_csv("../Library/Data/gender.csv")
```

Note that each row in the dataset represents a different combination of founding year and gender of leadership, mean the variables `founded` and `gender` uniquely identify the dataset.

```{r}
# Printing the first five rows of the data to visualize its structure before data wrangling
head(data)
```

# Create the graph

```{r}
# Define the vector of colors to be used in the graph
gender_colors <- c("#F4BA3B", "#730B6D")

# Create the graph
data %>%
  ggplot() +
  geom_area(aes(x = founded, 
                y = n_gender, 
                fill = gender)) + # Different fill colors will indicate different gender of leadership
  # Annotation
  labs(x = "Year firm was founded", 
       y = "Number of firms",
       title = "Year firm was founded, by gender of leaders") +
  # Colors
  scale_fill_manual(values = gender_colors, # Use the color palette previously defined
                    na.value = "gray") + # Missing values will be filled in gray
  # Graph formatting
  theme_classic() +
  theme(
    legend.position = "top",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    panel.grid.major = element_line()
  )

```

